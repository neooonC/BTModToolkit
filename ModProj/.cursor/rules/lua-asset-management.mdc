---
title: "Asset Management for Lua Mods"
description: "Asset loading patterns for Lua VR mod code generation"
type: "patterns"
globs: ["Assets/Build/**/*", "**/*.asset"]
alwaysApply: false
tags: ["assets", "addressables", "lua"]
---

# Asset Management for Lua Mods

## Resource Paths (from Readme)
```lua
-- Standard resource paths with automatic prefix handling
"Weapon/MagicSword"           -- Loaded as CL.ResourceMgr.Load("MagicSword")
"LuaScript/WeaponBase"        -- Loaded as CL.ResourceMgr.Load("WeaponBase")  
"ICon/weapon_sword"           -- Loaded as CL.ResourceMgr.Load("weapon_sword")
"Effect/explosion"            -- Loaded as CL.EffectMgr.Instance:PlayEffect("explosion")
"Audio/Sound/bow_release"     -- Loaded as CL.ResourceMgr.Load("bow_release")
"FlyObj/magic_arrow"          -- Loaded as CL.ResourceMgr.Load("magic_arrow")

-- Entry Point Convention
"LuaScript/Entry"             -- Mod entry point script
```

## Loading Patterns
```lua
-- Basic asset loading
local weapon = CL.ResourceMgr.Instantiate("WMD_MagicBow")
local audioClip = CL.ResourceMgr.Load("Audio/BowStringRelease")

-- Async loading with callback
CL.ResourceMgr.LoadAsync("WMD_FireArrow", function(asset)
    self._arrowPrefab = asset
end)

-- Effect loading (path prefix automatic)
CL.EffectMgr.Instance:PlayEffect("explosion")   -- "Effect/explosion"
CL.EffectMgr.Instance:PlayEffect("trail_magic") -- "Effect/trail_magic"
```

## Asset Manager Pattern
```lua
local AssetManager = {
    _loadedAssets = {},
}

function AssetManager:LoadAsset(address, callback)
    if self._loadedAssets[address] then
        if callback then callback(self._loadedAssets[address]) end
        return
    end
    
    CL.ResourceMgr.LoadAsync(address, function(asset)
        self._loadedAssets[address] = asset
        if callback then callback(asset) end
    end)
end

function AssetManager:GetAsset(address)
    return self._loadedAssets[address]
end

function AssetManager:CleanupAssets()
    for address, asset in pairs(self._loadedAssets) do
        if asset then UE.Object.Destroy(asset) end
        self._loadedAssets[address] = nil
    end
end
```

## Network Prefab Registration
```lua
-- networkPrefabRegister in Config asset
-- All FlyObjects created via CL.FlyObject.CreateFlyObj() must be registered
networkPrefabRegister = {
    "WMD_Bow_Magic",           -- Main weapon
    "WMD_FireBall",            -- Projectile
    "WMD_MagicArrowTrail",     -- Effects
}
```
